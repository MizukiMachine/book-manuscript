##  はじめに
:::message
テスト駆動開発(TDD)の知識がゼロでもはじめられるように補足しながら書いています
:::

「TDDって何？」という方はこちらの記事をどうぞ
https://zenn.dev/nezumizuki/articles/fa821accc95050

TodoリストAPI開発を通して、実践的な開発シナリオでハンズオンTDDを行います。

## 実践的なTDDの考え方

### 1 TDDの三原則を振り返る

実践に入る前に、TDDの基本原則を確認しましょう

1. **先にテストを書く**
   ```typescript
   // ✅ 正しいアプローチ
   test('createTodo creates a new todo', async () => {
     const todo = await todoRepository.create({ title: 'Test Todo' });
     expect(todo.id).toBeDefined();
   });
   
   // ❌ 間違ったアプローチ
   // 実装を先に書いて、後からテストを追加
   ```

2. **テストが失敗することを確認**
   ```bash
   # テスト実行結果の例
   FAIL src/repositories/__tests__/todo.repository.test.ts
     ● TodoRepository › createTodo › creates a new todo
       TypeError: Cannot read properties of undefined (reading 'create')
   ```

3. **最小限の実装でテストを通す**
   ```typescript
   export class TodoRepository {
     async create(data: CreateTodoDTO): Promise<Todo> {
       return {
         id: '1',  // とりあえずハードコード
         ...data,
         completed: false,
         createdAt: new Date(),
         updatedAt: new Date()
       };
     }
   }
   ```

### 2 実践的なTDDのポイント

実際の開発では、以下のポイントを意識することが重要です。

1. **テストの粒度を適切に保つ**
   - 小さすぎる：実装の自由度が下がる
   - 大きすぎる：テストの意図が不明確になる

2. **境界値のテストを重視**
   ```typescript
   describe('TodoRepository', () => {
     describe('create', () => {
       test('throws error for empty title', async () => {
         await expect(
           todoRepository.create({ title: '' })
         ).rejects.toThrow('Title cannot be empty');
       });

       test('trims whitespace from title', async () => {
         const todo = await todoRepository.create({ title: '  Test Todo  ' });
         expect(todo.title).toBe('Test Todo');
       });
     });
   });
   ```

3. **テストの意図を明確に**
   ```typescript
   // ✅ 良い例：テストの意図が明確
   test('marks todo as completed when toggle is called', async () => {
     const todo = await todoRepository.create({ title: 'Test' });
     const updated = await todoRepository.toggleComplete(todo.id);
     expect(updated.completed).toBe(true);
   });

   // ❌ 悪い例：テストの意図が不明確
   test('toggle works', async () => {
     const t = await repo.create({ title: 't' });
     const u = await repo.toggle(t.id);
     expect(u.completed).toBe(true);
   });
   ```


前置きはこのくらいにして、次のチャプターからはさっそく手を動かしていきます。
